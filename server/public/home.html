<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="home.css" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <table id="customers">
      <tr>
        <th>Trạm</th>
        <th>Mã trạm</th>
        <th>Địa chỉ</th>
      </tr>
    </table>
  </body>
  <script>
    //Get list stations from database - collection "listStations"
    getListStations = async () => {
      console.log("HTTP GET with Axios");
      axios
        .get("http://localhost:8080/stations", {
          headers: { "auth-token": localStorage.getItem("auth-token") },
        })
        .then((response) => {
          if (response.data === false) {
            console.l;
            window.location.href = "http://localhost:8080/public/login.html";
          }
          let listStations = response.data;
          handleData(listStations);
        })
        .catch((error) => {
          if (error.response) {
            console.log(error.reponse.status);
          } else {
            console.log(error.message);
          }
        });
    };
    getListStations();

    //Handle Data
    handleData = async (listStations) => {
      listStations.forEach((station) => {
        let tableElement = document.getElementById("customers");
        console.log(station);
        let tr = document.createElement("TR");
        let td1 = document.createElement("TD");
        let a = document.createElement("A");
        a.href = "./station.html";
        a.textContent = station.station_name;
        a.addEventListener("click", function () {
          localStorage.setItem("station_id", station.station_id);
          localStorage.setItem("station_name", station.station_name);
        });
        td1.appendChild(a);
        let td2 = document.createElement("TD");
        let td3 = document.createElement("TD");
        td2.textContent = station.station_id;
        td3.textContent = station.station_address;
        tr.appendChild(td1);
        tr.appendChild(td2);
        tr.appendChild(td3);
        tableElement.appendChild(tr);
      });
    };
  </script>
</html>
